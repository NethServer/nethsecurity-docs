.. _openvpn_roadwarrior-section:

====================
OpenVPN Road Warrior
====================


Road Warrior refers to a specific configuration of the OpenVPN VPN tailored for remote users, allowing them secure access to a
private network from anywhere on the internet.
This setup is particularly useful for businesses and organizations with employees or collaborators spread across different locations,
ensuring encrypted communication and data privacy.

.. note::  Before configuring the OpenVPN Roadwarrior, make sure you have read the chapter related to the :ref:`user database <users_database-section>`.

How it works
------------

An OpenVPN server is running on NethSecurity waiting for remote clients to contact it and establish a connection, it must be reachable from the internet on its specific port (default: 1194 UDP).
Multiple clients can connect to the server, authenticate themselves and gain access to the private network; however, the clients do not need to be reachable on the internet. Each connecting client, after authentication, receives an IP address with which it will present itself to the remote network.

Databases
^^^^^^^^^

An OpenVPN server on NethSecurity is closely tied to a user database, which can be local (already present by default, just needs to be populated with users) or remote to connect to an LDAP or Active Directory server. The association with the database is defined during server creation and cannot be modified later.

On the OpenVPN server, OpenVPN accounts linked to users from the specific database can be created.

Server Configuration
--------------------

To configure a new OpenVPN server click :guilabel:`Create Server` button and configure/verify the proposed fileds:

``Server name`` : give a name to this OpenVPN server

``User database`` : choose the database where account will be created

``Create an account for each user`` : this is a special field and won't be showed again the future, it allows you to automatically create a VPN account for each user present in the database. All accounts created will have a certificate valid for 3650 days.

``Mode`` : Bridged or routed (default routed)

``Authentication mode`` : several authentication modes are supported:

* Username and password : the connecting client must provide a valid username and password

* Certificate : the connecting client must have its own certificate to authenticate (easiest way)

* Username password and certificate : the connecting client must provide a valid username, password and the related certificate 

* Username OTP and certificate : the connecting client must provide a valid username, certificate and also an OTP code used as a password.This mode require an additional configuration in the client to receive to OTP code

``VPN Network`` : the virtual network used by clients; every client will receive an IP address taken from this network. NethSecurity already suggests an uncommon network to avoid overlaps with other networks used by the firewall.

``Public IP/hostname of this unit`` : NethSecurity automatically fill this field with the public IP address of each configured WAN interface.
These IPs/hostnames will go into the client configuration.
The order of the elements is crucial because the connectiong client will start contacting the IPs/hostnames beginning with the first in the list and then progressing down the list in case of unavailability.

Advanced settings
^^^^^^^^^^^^^^^^^

``Protocol`` : UDP (default) , TCP 

``Port`` : 1194 (default)

``Route all client traffic though VPN`` : if enabled, it routes all traffic generated by the client into the VPN tunnel, even standard internet traffic. It can be used for monitoring and control purposes, but is typically disabled because it introduces increased latency and consumes bandwidth.

``Push network routes`` : the networks that will be routed in the VPN tunnel, the LAN networks are automatically added, but they can also be removed and other networks can be added in the same way

``Allow client-to-client network traffic`` :  allows two clients connected in VPN to exchange traffic; however, it is recommended to leave it disabled.

``Compression`` : It allows compressing the OpenVPN tunnel traffic to save bandwidth. However, it is now a less useful option and, in some cases, can be detrimental. It is recommended to leave it disabled. When this option is modified, it is necessary to download the client configuration again.

``Digest`` : Digest (default SHA 256)

``Cipher`` : Cipher used (default AES-256-GCM) 

``Enforce a minimum TLS version`` : Allows connection only for clients using a TLS version equal to or greater than the one specified.

``Custom DHCP options`` : Allows you to pass specific DHCP options to the client (e.g. DOMAIN, DNS, WINS and so on)


Client 
--------------------
ogni client un account
no contemporaneit√†

Clients connected to the Road Warrior are assigned to the ``rwopenvpn`` zone, which is inherently trusted.
This zone has privileged access to both LAN and WAN zones within the network infrastructure.



